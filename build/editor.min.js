/*! editor 2015-01-04 */
function Editor(){return this.init()}!function(a,b,c,d){"use strict";function e(){}function f(a,b){for(var c=b.parentNode;null!==c;){if(c===a)return!0;c=c.parentNode}return!1}function g(a){var b,c,d,e=a.options.contentWindow.getSelection();if(e.getRangeAt&&e.rangeCount){for(d=[],b=0,c=e.rangeCount;c>b;b+=1)d.push(e.getRangeAt(b));return d}return null}function h(a,b){var c,d,e=a.options.contentWindow.getSelection();if(b)for(e.removeAllRanges(),c=0,d=b.length;d>c;c+=1)e.addRange(b[c])}function i(a){var b=a.options.ownerDocument.getSelection().anchorNode,c=b&&3===b.nodeType?b.parentNode:b;return c}function j(a){var b,c,e,f,g="";if(a.options.contentWindow.getSelection!==d){if(c=a.options.contentWindow.getSelection(),c.rangeCount){for(f=a.options.ownerDocument.createElement("div"),b=0,e=c.rangeCount;e>b;b+=1)f.appendChild(c.getRangeAt(b).cloneContents());g=f.innerHTML}}else a.options.ownerDocument.selection!==d&&"Text"===a.options.ownerDocument.selection.type&&(g=a.options.ownerDocument.selection.createRange().htmlText);return g}function k(b,c){var d,e,f,g,h,i;if(b.queryCommandSupported&&b.queryCommandSupported("insertHTML"))return b.execCommand("insertHTML",!1,c);if(d=a.getSelection(),d.getRangeAt&&d.rangeCount){for(e=d.getRangeAt(0),e.deleteContents(),f=b.createElement("div"),f.innerHTML=c,g=b.createDocumentFragment();f.firstChild;)h=f.firstChild,i=g.appendChild(h);e.insertNode(g),i&&(e=e.cloneRange(),e.setStartAfter(i),e.collapse(!0),d.removeAllRanges(),d.addRange(e))}}function l(a){var b={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"caps",27:"esc",32:"space",33:"pgup",34:"pgdn",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"cmd",93:"cmd",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",186:";",187:"=",188:",",189:"-",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},c=[],e=[];return a===d||a.which===d?"@":(a.altKey&&c.push(b[18]),a.metaKey&&c.push(b[91]),a.ctrlKey&&c.push(b[17]),a.shiftKey&&c.push(b[16]),c.length&&e.push(c.join("+")),b.hasOwnProperty(a.which)&&e.push(b[a.which]),"@"+e.join("+"))}Editor.prototype={options:{cleanPastedHTML:!0,delay:0,diffLeft:0,diffTop:-10,disableReturn:!0,elementsContainer:!1,contentWindow:a,ownerDocument:b,firstHeader:"h3",forcePlainText:!0,placeholder:"Type your text",secondHeader:"h4",targetBlank:!1,tabCharacter:"    ",anchorTarget:!1,extensions:[],buttonIdCounter:0,bindings:{}},isIE:"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),init:function(){return this.parentElements=["p","h1","h2","h3","h4","h5","h6","pre","blockquote"],this.setup(),this},setup:function(){this.initElements().bindSelect().bindPaste().bindElementActions().bindWindowActions()},on:function(a,b,c,d){this.elements.root.on(a,b,c,d)},off:function(a,b,c){this.elements.root.off(a,b,c)},initElements:function(){var a;if(this.elements={},a=c("[data-editor]"),a.length>1)console.log("Multiple editors not supported. Picking up first."),a=a.first();else if(0===a.length)throw"Editor root element not found";return this.elements.root=a,a=this.elements.root.find("[data-menu-container]"),0===a.length&&(a=c("<div>").attr("data-menu-container","").addClass("menu-container"),this.elements.root.append(a)),this.elements.menuContainer=a,a=this.elements.root.find("[data-edit]"),0===a.length&&(a=c("<article>").attr("data-edit","").append(c("<h2>").attr("data-placeholder","Title here").addClass("title")).append(c("<p>").attr("data-placeholder","Your text here")),this.elements.root.append(a)),this.elements.editable=a,this.elements.editable.attr({contenteditable:!0}),this},bindSelect:function(){var a=this,b=-1,d=function(c){a.event=c,c&&a.clickingOnMenuElement(c)||(clearTimeout(b),b=setTimeout(function(){a.checkSelection()},a.options.delay))};return c(this.options.ownerDocument).on("mouseup",d),this.elements.root.on("keyup",d),this.elements.root.on("blur",d),this.elements.editable.on("click",d),this},bindPaste:function(){var b=this,c=function(c){var e,f,g="",h="text/html",i="text/plain";if(!b.options.forcePlainText&&!b.options.cleanPastedHTML)return this;if(a.clipboardData&&c.clipboardData===d&&(c.clipboardData=a.clipboardData,h="Text",i="Text"),c.clipboardData&&c.clipboardData.getData&&!c.defaultPrevented){if(c.preventDefault(),b.options.cleanPastedHTML&&c.clipboardData.getData(h))return b.cleanPaste(c.clipboardData.getData(h));if(b.options.disableReturn)g=b.htmlEntities(c.clipboardData.getData(i)),k(b.options.ownerDocument,g);else{for(e=c.clipboardData.getData(i).split(/[\r\n]/g),f=0;f<e.length;f+=1)""!==e[f]&&(g+=navigator.userAgent.match(/firefox/i)&&0===f?b.htmlEntities(e[f]):"<p>"+b.htmlEntities(e[f])+"</p>");k(b.options.ownerDocument,g)}}};return this.elements.editable.on("paste",c),this},bindElementActions:function(){return this.bindReturn().bindTab().bindBlur().bindButtons().bindKeypress(),this},bindReturn:function(){var a=this;return this.elements.editable.on("keypress",function(b){13===b.which&&a.options.disableReturn&&(b.altKey||b.shiftKey||b.ctrlKey||b.metaKey)&&(console.log("disabling"),b.preventDefault())}),this},bindTab:function(){var a=this;return this.elements.editable.on("keydown",function(c){if(9===c.which){var d=i(a).tagName.toLowerCase();"pre"===d&&(c.preventDefault(),b.execCommand("insertHtml",null,a.options.tabCharacter)),"li"===d&&(c.preventDefault(),c.shiftKey?b.execCommand("outdent",c):b.execCommand("indent",c))}}),this},bindBlur:function(){var a=this,c=function(b){b.target===a.toolbar||b.target===a.elements.root[0]||f(a.elements.root[0],b.target)||setTimeout(function(){a.blurExtensions()},200)};return b.body.addEventListener("click",c,!0),b.body.addEventListener("focus",c,!0),this},bindKeypress:function(){return this.elements.editable.on("keypress",function(){}),this},bindButtons:function(){var a=this;return this.elements.menuContainer.on("click",'a[href="#"]',function(b){b.preventDefault(),a.onButtonClick(c(this),b)}),this},bindWindowActions:function(){var a,b=this,d=function(){clearTimeout(a),a=setTimeout(function(){b.refreshExtensions()},100)};return c(this.options.contentWindow).on("resize",d),this},checkSelection:function(){var a;return a=this.options.contentWindow.getSelection(),this.selectionInContentEditableFalse()?this.blurExtensions():this.checkSelectionElement(a),this},clickingOnMenuElement:function(a){var b=this;return a.type&&"blur"===a.type.toLowerCase()&&a.relatedTarget&&f(b.elements.menuContainer[0],a.relatedTarget)?!0:!1},hasMultiParagraphs:function(){var a=j(this).replace(/<[\S]+><\/[\S]+>/gim,""),b=a.match(/<(p|h[0-6]|blockquote)>([\s\S]*?)<\/(p|h[0-6]|blockquote)>/g);return b?b.length:0},checkSelectionElement:function(a){var b,d,e,f,g=this,h=!1;if("click"===this.event.type)this.propagateEvent("@click",this.event),b=this.event.target,f=c(b).position();else if("blur"===this.event.type)return b=this.event.target,void this.blurExtensions();if(("mouseup"===this.event.type||"keyup"===this.event.type)&&(b=a.focusNode,a.rangeCount?(d=a.getRangeAt(0),f=d.getBoundingClientRect()):f=c(this.findNodeInEditable(this.event.target,function(a){return a.parentNode===g.elements.editable[0]})).position(),h=a.blur||this.state&&this.state.focusNode!==b),e={top:f.top,right:f.right,bottom:f.bottom,left:f.left,hcenter:(f.left+f.right)/2,vcenter:(f.top+f.bottom)/2},this.state={focusNode:b,nodeList:this.createNodeList(b),selection:a,range:d,position:e},h&&this.blurExtensions(),console.log(this.event.type),"keyup"===this.event.type){var i=l(this.event);"@"!==i&&this.propagateEvent(i,this.event)}b&&("mouseup"===this.event.type||"keyup"===this.event.type)&&(this.wildcardHandler(),this.nodeHandler(b.nodeName.toLowerCase()))},selectionInContentEditableFalse:function(){return this.findMatchingSelectionParent(function(a){return a&&"#text"!==a.nodeName&&"false"===a.getAttribute("contenteditable")})},findMatchingSelectionParent:function(a){var b,c,d=this.options.contentWindow.getSelection();if(0===d.rangeCount)return!1;b=d.getRangeAt(0),c=b.commonAncestorContainer;do{if(1===c.nodeType){if(a(c))return c;if(c.hasAttribute("data-edit"))return!1}c=c.parentNode}while(c);return!1},findNodeInEditable:function(a,b){if(!a)return this.elements.editable[0];for(;a.parentNode;){if(b(a))return a;if(a==this.elements.editable[0])break;a=a.parentNode}return this.elements.editable[0]},getRootNode:function(a){var b=this;return this.findNodeInEditable(a,function(a){return a.parentNode==b.elements.editable[0]})},cleanPaste:function(a){var b,c,d,e=this.elements.editable[0],f=/<p|<br|<div/.test(a),g=[[new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi),""],[new RegExp(/<\/b>(<br[^>]*>)?$/gi),""],[new RegExp(/<span class="Apple-converted-space">\s+<\/span>/g)," "],[new RegExp(/<br class="Apple-interchange-newline">/g),"<br>"],[new RegExp(/<span[^>]*(font-style:italic;font-weight:bold|font-weight:bold;font-style:italic)[^>]*>/gi),'<span class="replace-with italic bold">'],[new RegExp(/<span[^>]*font-style:italic[^>]*>/gi),'<span class="replace-with italic">'],[new RegExp(/<span[^>]*font-weight:bold[^>]*>/gi),'<span class="replace-with bold">'],[new RegExp(/&lt;(\/?)(i|b|a)&gt;/gi),"<$1$2>"],[new RegExp(/&lt;a\s+href=(&quot;|&rdquo;|&ldquo;|“|”)([^&]+)(&quot;|&rdquo;|&ldquo;|“|”)&gt;/gi),'<a href="$2">']];for(b=0;b<g.length;b+=1)a=a.replace(g[b][0],g[b][1]);if(f)for(c=a.split("<br><br>"),this.pasteHTML("<p>"+c.join("</p><p>")+"</p>"),this.options.ownerDocument.execCommand("insertText",!1,"\n"),c=e.querySelectorAll("a,p,div,br"),b=0;b<c.length;b+=1)switch(d=c[b],d.tagName.toLowerCase()){case"a":this.options.targetBlank&&this.setTargetBlank(d);break;case"p":case"div":this.filterCommonBlocks(d);break;case"br":this.filterLineBreak(d)}else this.pasteHTML(a)},setTargetBlank:function(a){var b;if(a=a||i(this),"a"===a.tagName.toLowerCase())a.target="_blank";else for(a=a.getElementsByTagName("a"),b=0;b<a.length;b+=1)a[b].target="_blank"},isCommonBlock:function(a){return a&&("p"===a.tagName.toLowerCase()||"div"===a.tagName.toLowerCase())},filterCommonBlocks:function(a){/^\s*$/.test(a.textContent)&&a.parentNode.removeChild(a)},filterLineBreak:function(a){this.isCommonBlock(a.previousElementSibling)?a.parentNode.removeChild(a):!this.isCommonBlock(a.parentNode)||a.parentNode.firstChild!==a&&a.parentNode.lastChild!==a?1===a.parentNode.childElementCount&&this.removeWithParent(a):a.parentNode.removeChild(a)},removeWithParent:function(a){a&&a.parentNode&&(a.parentNode.parentNode&&1===a.parentNode.childElementCount?a.parentNode.parentNode.removeChild(a.parentNode):a.parentNode.removeChild(a.parentNode))},pasteHTML:function(a){var b,c,d,e,f=this.options.ownerDocument.createDocumentFragment();for(f.appendChild(this.options.ownerDocument.createElement("body")),e=f.querySelector("body"),e.innerHTML=a,this.cleanupSpans(e),b=e.querySelectorAll("*"),d=0;d<b.length;d+=1)c=b[d],c.removeAttribute("class"),c.removeAttribute("style"),c.removeAttribute("dir"),"meta"===c.tagName.toLowerCase()&&c.parentNode.removeChild(c);this.options.ownerDocument.execCommand("insertHTML",!1,e.innerHTML.replace(/&nbsp;/g," "))},cleanupSpans:function(a){var b,c,d,e=a.querySelectorAll(".replace-with");for(b=0;b<e.length;b+=1)c=e[b],d=this.options.ownerDocument.createElement(c.classList.contains("bold")?"b":"i"),d.innerHTML=c.classList.contains("bold")&&c.classList.contains("italic")?"<i>"+c.innerHTML+"</i>":c.innerHTML,c.parentNode.replaceChild(d,c);for(e=a.querySelectorAll("span"),b=0;b<e.length;b+=1)c=e[b],/^\s*$/.test()?c.parentNode.removeChild(c):c.parentNode.replaceChild(this.options.ownerDocument.createTextNode(c.textContent),c)},htmlEntities:function(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},install:function(a){if(a){a=c.extend(new e,a),a.id=this.options.extensions.length,this.options.extensions.push(a),a.base=this,a.subscribe===d&&(a.subscribe=[]);var b,f,g=this;this.elements.menuContainer.append(a.view),a.view.css({position:"absolute"}).hide(),a.R={},a.view.find("[data-button-id]").each(function(){var b=c(this).attr("data-button-id").replace(/-([a-z0-9])/gi,function(a){return a[1].toUpperCase()});g.options.buttonIdCounter+=1,a.R[b]=g.options.buttonIdCounter,c(this).attr("data-extension-id",a.id),c(this).attr("data-id",g.options.buttonIdCounter)}),f=[],a.subscribe.forEach(function(c){b=/^@.*$/gi,b.test(c)?(g.options.bindings[c]||(g.options.bindings[c]=[]),g.options.bindings[c].push(a)):f.push(c)}),a.subscribe=f,a.init()}return this},createView:function(a){var b,e=c("<div>"),f=function(a,b,d){var e=a.split(","),f=c("<a>").addClass("button").attr("href","#");e[0]&&f.attr("data-button-id",e[0]),e[1]&&f.html('<i class="fa fa-'+e[1]+'"></i>'),e[2]&&f.html(f.html()+e[2]),f.attr(b),d.append(c("<li>").append(f))};return a&&a instanceof Array?(b=c("<ul>"),a.forEach(function(a){var g,h,i;if(a instanceof Object){switch(g=a.sep,h=a.name,i=a.break||!1,b===d&&(b=c("<ul>")),a.type){case"select":a.buttons.forEach(function(a){f(a,{"data-button-type":"select","data-button-name":h},b)});break;case"radio":a.buttons.forEach(function(a){f(a,{"data-button-type":"radio","data-button-name":h},b)});break;case"checkbox":a.buttons.forEach(function(a){f(a,{"data-button-type":"checkbox"},b)});break;default:a.buttons.forEach(function(a){f(a,{},b)})}g===!0&&b.find("li:last-child").addClass("sep-right"),i===!0&&(e.append(b.addClass("menu default")),b=d)}}),b&&e.append(b.addClass("menu default")),e):""},createNodeList:function(a){var b={};if(a&&f(this.elements.editable[0],a))for(;a.parentNode&&(b[a.nodeName.toLowerCase()]=!0,a=a.parentNode,!a.hasAttribute("data-edit")););return b},propagateEvent:function(a,b){return this.options.bindings.hasOwnProperty(a)&&this.options.bindings[a].some(function(c){return c.onEvent(a,b)}),this},wildcardHandler:function(){return this.nodeHandler("*")},nodeHandler:function(a){return this.state?(this.options.extensions.forEach(function(b){-1!==b.subscribe.indexOf(a)&&(b.isActive||b.focusIn(a))}),this):this},blurExtensions:function(){return this.state?(this.options.extensions.forEach(function(a){a.isActive===!1&&(a.focusOut(),a.isActive=!1)}),this):this},refreshExtensions:function(){return this.state?(this.options.extensions.forEach(function(a){a.refresh()}),this):this},onButtonClick:function(a,b){var c,d,e;c=parseInt(a.attr("data-extension-id"),10),console.log("button#click"),this.options.extensions[c]&&(e=this.getButtonValue(a),d=parseInt(a.attr("data-id"),10),console.log(this.options.extensions[c].name),!0===this.options.extensions[c].onClick(d,e,a,b)&&this.updateButtonState(a))},getButtonValue:function(a){var b=a.is("[selected]");switch(a.attr("data-button-type")){case"select":return b?d:a.attr("data-button-id");case"radio":return a.attr("data-button-id");case"checkbox":return!b;default:return!0}},updateButtonState:function(a){if("radio"===a.attr("data-button-type"))return a.attr("selected","");if(a.attr("data-button-type"))return a.is("[selected]")?a.removeAttr("selected"):a.attr("selected","")},execFormatBlock:function(a){var b=this.getSelectionData(this.state.selection.anchorNode);if("blockquote"===a&&b.el&&"blockquote"===b.el.parentNode.tagName.toLowerCase())return this.options.ownerDocument.execCommand("outdent",!1,null);if(b.tagName===a&&(a="p"),this.isIE){if("blockquote"===a)return this.options.ownerDocument.execCommand("indent",!1,a);a="<"+a+">"}return console.log("FormatBlock::"+a),this.options.ownerDocument.execCommand("formatBlock",!1,a)},getSelectionData:function(a){var b;for(a&&a.tagName&&(b=a.tagName.toLowerCase());a&&-1===this.parentElements.indexOf(b);)a=a.parentNode,a&&a.tagName&&(b=a.tagName.toLowerCase());return{el:a,tagName:b}},execFormatCode:function(){var a,d,e,f=j(this);return this.state&&this.state.selection.rangeCount?(d=this.state.selection.getRangeAt(0),e=this.createNodeList(this.state.selection.focusNode),e.code?(a=b.createElement("span"),d.deleteContents(),this.state.selection.focusNode.innerHTML||c(this.state.selection.focusNode).contents().remove(),a.innerHTML=f):(a=b.createElement("code"),a.innerHTML=f.replace(/<\/?code>/gi,""),d.deleteContents()),d.insertNode(a),d.setStartBefore(a),d.setEndAfter(a),this.state.selection.removeAllRanges(),this.state.selection.addRange(d),!0):!1},execInsertNewLine:function(){var a,b;return this.state&&this.state.selection.rangeCount?(a=this.state.selection.getRangeAt(0),b=a.createContextualFragment("<br>"),a.insertNode(b),a.setStartAfter(a.endContainer.nextSibling),this.state.selection.removeAllRanges(),this.state.selection.addRange(a),!0):!1},execCommand:function(a,c){b.execCommand(a,!1,c)},stripTags:function(a){var c=b.createElement("DIV");return c.innerHTML=a,c.textContent||c.innerText||""},saveSelection:function(){this.savedSelection=g(this)},restoreSelection:function(){h(this,this.savedSelection)}},e.prototype={refresh:function(){this.view.css({top:this.base.state.position.top,left:this.base.state.position.left})},onClick:function(){},onEvent:function(){},focusIn:function(){},focusOut:function(){},init:function(){}},a.Editor=new Editor,Editor.elements.editable.focus()}(window,document,window.jQuery),function(a,b){function c(){this.view=a.createView([{buttons:["text,paragraph,TEXT","image,image,IMAGE","video,youtube-play,VIDEO","embed,code,EMBED","bg,image,BG IMAGE","quote,quote-right,QUOTE","line,minus,LINE","audio,volume-up,AUDIO","gallery,gamepad,GALLERY","map,map-marker,MAP","code,code,CODE","temp,anything,&nbsp;"]}]),this.view.prepend(b("<div>").addClass("toggle").html('<a class="button icon" href="#" data-button-id="toggle">×</a>'))}c.prototype={name:"options",subscribe:["*"],open:function(){var a=30*this.view.find("li").length;this.view.find(".menu").css({height:3,width:0}).show().animate({width:292},{duration:200,queue:!0}).animate({height:a},{duration:200,queue:!0})},close:function(){var a=this.view.find(".menu");a.animate({height:3},{duration:200,queue:!0}).animate({width:0},{duration:200,queue:!0,complete:function(){a.hide()}})},onClick:function(a){switch(a){case this.R.toggle:if(!this.view.find("ul").is(":visible"))return void this.open();break;case this.R.image:this.addImagePlaceholder()}this.close()},addImagePlaceholder:function(){var a=b("<img>"),c=b("<div>").html('<div class="placeholder-overlay"></div>'),d=b("<div>").addClass("image-placeholder").html('<div class="main-container"><i class="fa fa-2x fa-camera"></i><br>Drag and drop your photos here <br>or<br><a href="#" data-id="add">Add photos manually</a></div><div class="sub-container"><div><a href="#" data-id="web-url">Web URL</a> <a href="#" data-id="prev">Previous Photos</a></div><div><a href="#" data-id="remove">Remove</a> <a href="#" data-id="done">Done</a><input style="display: none" type="file"></div></div>').data(a),e=b(this.base.getRootNode(this.base.state.focusNode)),f=this;e.after(a),c.append(d),this.base.elements.menuContainer.append(c),this.base.saveSelection(),d.css("position","absolute").css(a.position()),d.on("click","a",function(e){f.imageHandler(e,b(this).attr("data-id"),d,c,a)})},imageHandler:function(a,c,d,e,f){switch(c){case"remove":f.remove(),e.remove();break;case"add":e.find("input[type=file]").click();break;case"web-url":var g=this;d.find(".main-container").html('<i class="fa fa-2x fa-camera"></i><br><input type="url" placeholder="paste your link here and press Enter">').find("input").focus().keypress(function(a){13===a.which&&(e.attr("data-src",b(this).val()),g.imageHandler(a,"done",d,e,f))}),d.find("[data-id=web-url]").hide(),d.find("[data-id=prev]").hide();break;case"done":var h=e.attr("data-src");h||(h=d.find("input[type=url]").val()),this.base.restoreSelection(),f.attr("src",h),e.remove()}},focusIn:function(){var c=b(a.getRootNode(this.base.state.focusNode));c&&this.view.css({top:Math.max(0,c.position().top+8),left:Math.max(-8,c.position().left-this.width-32)})},init:function(){var a=this.base.elements.editable.find(":last-child").position();this.view.find("ul").removeClass("default").addClass("options-menu").hide(),this.height=32|this.view.find(".toggle").height(),this.width=32|this.view.find(".toggle").width(),this.view.css({top:Math.max(0,a.top),left:Math.max(-8,a.left-this.width-32)}),this.view.show()}},a.install(new c)}(window.Editor,window.jQuery,window),function(a,b){function c(){this.view=a.createView([{name:"headings",type:"select",buttons:["h1,,<b>H1</b>","h2,,<b>H2</b>","h3,,<b>H3</b>"],sep:!0},{buttons:["bold,,<b>B</b>","italic,,<b><i>i</i></b>"],type:"checkbox",sep:!0},{name:"aligns",buttons:["align-left,align-left","align-center,align-center"],type:"radio",sep:!0},{buttons:["link,link","code,,{}","quote,quote-right"],"break":!0},{buttons:["link-cancel,times","link-add,check"],group:!0}])}c.prototype={name:"text",subscribe:["@cmd+b","@ctrl+b","@cmd+i","@ctrl+i","@alt+enter","@shift+enter","#text","div","a","span","code","p","blockquote","q","b","i","strong","em","h1","h2","h3","h4","h5","h6"],onClick:function(b,c){switch(console.log(b+" "+c),b){case this.R.h1:return a.execFormatBlock("h1");case this.R.h2:return a.execFormatBlock("h2");case this.R.h3:return a.execFormatBlock("h3");case this.R.quote:return a.execFormatBlock("blockquote");case this.R.bold:return document.execCommand("bold",!1,null);case this.R.italic:return document.execCommand("italic",!1,null);case this.R.alignLeft:document.execCommand("justifyleft",!1,null);break;case this.R.alignCenter:document.execCommand("justifycenter",!1,null);break;case this.R.link:this.openDialog();break;case this.R.linkAdd:this.dilogStatus=!1,this.addLink(this.input.val());break;case this.R.linkCancel:this.dilogStatus=!1,this.removeLink();break;case this.R.code:a.execFormatCode()}},focusIn:function(){this.dilogStatus!==!0&&(!1!==this.placeholder&&a.elements.editable.children().length>2&&(a.elements.editable.find("p[data-placeholder]").removeAttr("data-placeholder"),this.placeholder=!1),this.base.state.selection.isCollapsed?this.focusOut():(this.loadMenu(),this.loadState(),this.draw(),this.view.show()))},loadMenu:function(){},focusOut:function(){this.dilogStatus!==!0&&(this.isActive=!1,this.view.hide())},onEvent:function(a){switch(a){case"@cmd+b":case"@ctrl+b":return this.base.execCommand("bold"),!0;case"@cmd+i":case"@ctrl+i":return this.base.execCommand("italic"),!0;case"@shift+enter":return this.base.execInsertNewLine(),!0}return!1},draw:function(){var a=this.base.state.position;this.view.css({top:a.top-this.view.height()-8,left:a.hcenter-this.view.width()/2})},init:function(){var a=this.view.find(".menu"),c=this;a.last().prepend(b("<li>").append(b("<input>").attr({type:"text",placeholder:"Paste or type a link"})).on("keypress",function(a){13==a.which&&(c.dilogStatus=!1,c.addLink(c.input.val()))})).hide(),this.input=this.view.find("input"),this.view.append(b("<div>").addClass("nub nub-bottom")),this.tools=this.view.find(".menu").first(),this.dilog=this.view.find(".menu").last(),this.buttons={h1:this.view.find('a[data-button-id="h1"]'),h2:this.view.find('a[data-button-id="h2"]'),h3:this.view.find('a[data-button-id="h3"]'),bold:this.view.find('a[data-button-id="bold"]'),italic:this.view.find('a[data-button-id="italic"]'),alignLeft:this.view.find('a[data-button-id="align-left"]'),alignCenter:this.view.find('a[data-button-id="align-center"]'),link:this.view.find('a[data-button-id="link"]'),code:this.view.find('a[data-button-id="code"]'),quote:this.view.find('a[data-button-id="quote"]'),add:this.view.find('a[data-button-id="link-add"]'),cancel:this.view.find('a[data-button-id="link-cancel"]')}},loadState:function(){var c=b(this.base.getRootNode(this.base.state.focusNode)),d=a.state.nodeList;this.tools.show(),this.dilog.hide(),this.select(this.buttons.h1,d.h1).select(this.buttons.h2,d.h2).select(this.buttons.h3,d.h3).select(this.buttons.bold,d.b).select(this.buttons.italic,d.i).select(this.buttons.link,d.a).select(this.buttons.alignLeft,"left"==c.css("text-align")).select(this.buttons.alignCenter,"center"==c.css("text-align")).select(this.buttons.quote,d.blockquote).select(this.buttons.code,d.code)},openDialog:function(){var a=b(this.base.findNodeInEditable(this.base.state.focusNode,function(a){return"a"==a.nodeName.toLowerCase()})).attr("href");console.log(a),this.dilogStatus=!0,this.tools.hide(),this.dilog.show(),this.draw(),this.base.saveSelection(),this.input.val(a?a:""),this.input.focus()},addLink:function(a){a||(a="#--ignore"),this.base.restoreSelection(),this.base.execCommand("createLink",a),this.loadState()},removeLink:function(){var a;this.base.restoreSelection(),a=this.base.findNodeInEditable(this.base.state.selection.focusNode,function(a){return"a"==a.nodeName.toLowerCase()}),"a"==a.nodeName.toLowerCase()&&b(a).contents().unwrap()},select:function(a,b){return b?a.attr("selected",""):a.removeAttr("selected"),this}},a.install(new c)}(window.Editor,window.jQuery,window),function(a){function b(){this.view=a.createView([{name:"headings",type:"select",buttons:["medium,,Medium","large,,Large","small,,Small","small-left,,Small Left","full,,Full screen","full-text,,Full screen with overlay text"],sep:!0}])}b.prototype={name:"image",subscribe:["img"],onClick:function(a){switch(a){case this.R.small:break;case this.R.medium:break;case this.R.large:break;case this.R.smallLeft:break;case this.R.full:break;case this.R.fullText:}},focusIn:function(){var a=this.base.state.position;this.view.css({top:a.top-this.view.height()-8,left:a.hcenter-this.view.width()/2}).show()}}}(window.editor,window.jQuery,window,window.document);